#!/bin/bash

echo "###################################################################################"
echo "initiation started"
echo "###################################################################################"

wait 

sudo service redis-server start

wait

echo "###################################################################################"
echo "redis work"
echo "###################################################################################"

sudo service mysql start

wait

echo "###################################################################################"
echo "mysql work"
echo "###################################################################################"

wait

echo "create database wackcap" | mysql -u root -ppassword
echo "###################################################################################"
echo "wackcap database created"
echo "###################################################################################"


echo "###################################################################################"
echo "run migrations and seeds"
echo "###################################################################################"
cd services/users
npx sequelize db:migrate
wait 
npx sequelize-cli db:seed:all

pwd

cd ../conversations
npx sequelize db:migrate

echo "###################################################################################"
echo "good job every thing working well"
echo "###################################################################################"

wait

cd /code

echo "###################################################################################"
echo "use this url http://localhost:3000/register"
echo "###################################################################################"

npm start

